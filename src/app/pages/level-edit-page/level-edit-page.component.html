<navbar-teacher></navbar-teacher>

<div *ngIf="task" style="display: flex;" cdkDropListGroup>

    <div class="left-container">
        <div *ngFor="let command of commands">

            <div class="check-block">
                <input type="checkbox" (change)="onChange(command)" [checked]="getPos(command) != -1" />
                <div class="command" [ngStyle]="{'background-color' : command.color }">
                    {{command.text}}
                    <span *ngIf="command.text == 'Повторить'">
                        <select [(ngModel)]="command.numberOfRepeats">
                            <option *ngFor="let option of forOptions" [value]="option">{{option}}</option>
                        </select>
                        Раз
                    </span>
                    <ul *ngIf="command.type == 'composite'" class="program-ul">
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="central-container">
        <div class="group-name-container">
            <p>Название задания</p>
            <input type="text" placeholder="Название задания" [(ngModel)]=task.name>
        </div>

        <div class="params-container">

            <div style="display: flex;">
                <div>
                    <div class="number-block">
                        <label>n =</label> <input type="number" [(ngModel)]="task.n" (change)="NMChange()" min="4" max="18" />
                    </div>
                    <div class="number-block">
                        <label>n =</label> <input type="number" [(ngModel)]="task.m" (change)="NMChange()" min="4" max="18" />
                    </div>
                </div>
                <div class="rotate-block">
                    <p>Повернуть исполнителя</p>
                    <button (click) = "left()"><img src="assets/left.png" alt="Кнопка «button»"></button>
                    <button (click) = "right()"><img src="assets/right.png" alt="Кнопка «button»"></button>
                </div>
            </div>
            
            

            <div class="drop-block" cdkDropList>

            </div>
            <button (click)="save()" class="save-button">Сохранить</button>
        </div>


    </div>

    <div class="right-container">
        <div class="grid-block">
            <div class="grid"               
            [ngStyle]="{
                'grid-template-columns': 'repeat(' + this.task.m + ','+ this.cellSize +'%)',
                'grid-auto-rows' : this.cellSize + '%',
                'width' : (this.cellSize*max) +'%',
                'height' : (this.cellSize*max) +'%'
            }">
                <div class="cell" *ngFor="let symbol of cells; index as i"   
                cdkDropList
                [cdkDropListData]="items[i]"  
                (cdkDropListDropped)="transfer($event)"               
                    [class.target]="symbol == '2'" [class.active]="symbol == '1'" [class.disable]="symbol == '0'"
                    (click)="onClickCell(i)">
                    <div *ngIf="items[i].length > 0" cdkDrag>
                        <img  src="assets/arrow.png" [ngStyle] = "{
                            'transform': 'rotate(' + task.angle+'deg)'
                        }"/>
                    </div>  

                </div>
            </div>
        </div>
    </div>
</div>